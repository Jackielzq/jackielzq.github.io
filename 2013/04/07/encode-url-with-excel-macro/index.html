<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"jackielzq.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.15.1","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="在做广告推广时，如果该网站添加的是GA监测，那么不论是硬广还是SEM，通常都会在广告链接上加入utm参数已标记该次访问用户的来源。 那么问题就来了：如果我需要在界面上显示中文(比如标记的关键词)，该怎么做呢？GA默认是不会识别参数中的中文的，如果直接添加标记的话后果会比较严重，会导致你GA后台满目疮痍，显示出一堆的乱码，运气好的时候还能费点劲分辨出来，运气不好的话就没办法看报告了。这个时候我们就需">
<meta property="og:type" content="article">
<meta property="og:title" content="用EXCEL实现URL Encode转码">
<meta property="og:url" content="http://jackielzq.github.io/2013/04/07/encode-url-with-excel-macro/index.html">
<meta property="og:site_name" content="Jackie的博客">
<meta property="og:description" content="在做广告推广时，如果该网站添加的是GA监测，那么不论是硬广还是SEM，通常都会在广告链接上加入utm参数已标记该次访问用户的来源。 那么问题就来了：如果我需要在界面上显示中文(比如标记的关键词)，该怎么做呢？GA默认是不会识别参数中的中文的，如果直接添加标记的话后果会比较严重，会导致你GA后台满目疮痍，显示出一堆的乱码，运气好的时候还能费点劲分辨出来，运气不好的话就没办法看报告了。这个时候我们就需">
<meta property="og:locale">
<meta property="og:image" content="http://jackie.ms/wp-content/uploads/2013/04/lingcunwei1.jpg">
<meta property="og:image" content="http://jackie.ms/wp-content/uploads/2013/04/shezhidaohang.jpg">
<meta property="og:image" content="http://jackie.ms/wp-content/uploads/2013/04/visualbasic.jpg">
<meta property="og:image" content="http://jackie.ms/wp-content/uploads/2013/04/tianjiamokuai.jpg">
<meta property="og:image" content="http://jackie.ms/wp-content/uploads/2013/04/jieguo.jpg">
<meta property="article:published_time" content="2013-04-07T09:03:57.000Z">
<meta property="article:modified_time" content="2016-09-21T07:45:39.000Z">
<meta property="article:author" content="Jackielzq">
<meta property="article:tag" content="encode">
<meta property="article:tag" content="Excel">
<meta property="article:tag" content="转码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jackie.ms/wp-content/uploads/2013/04/lingcunwei1.jpg">


<link rel="canonical" href="http://jackielzq.github.io/2013/04/07/encode-url-with-excel-macro/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-Hans","comments":true,"permalink":"http://jackielzq.github.io/2013/04/07/encode-url-with-excel-macro/","path":"2013/04/07/encode-url-with-excel-macro/","title":"用EXCEL实现URL Encode转码"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>用EXCEL实现URL Encode转码 | Jackie的博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jackie的博客</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">学习|交流|分享</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-study"><a href="/study/" rel="section"><i class="fa fa-book fa-fw"></i>学习</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jackielzq"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Jackielzq</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">174</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">241</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://weibo.com/jackielzq" title="微博 → https:&#x2F;&#x2F;weibo.com&#x2F;jackielzq" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>微博</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/jackielzq" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;jackielzq" rel="noopener me" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="http://placeless.net/" title="http:&#x2F;&#x2F;placeless.net&#x2F;" rel="noopener" target="_blank">徐爷的文艺网站</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://cloga.info/" title="http:&#x2F;&#x2F;cloga.info" rel="noopener" target="_blank">龙爷财务自由之路</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://jackielzq.github.io/2013/04/07/encode-url-with-excel-macro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Jackielzq">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jackie的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="用EXCEL实现URL Encode转码 | Jackie的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          用EXCEL实现URL Encode转码
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2013-04-07 17:03:57" itemprop="dateCreated datePublished" datetime="2013-04-07T17:03:57+08:00">2013-04-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2016-09-21 15:45:39" itemprop="dateModified" datetime="2016-09-21T15:45:39+08:00">2016-09-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>780</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>在做广告推广时，如果该网站添加的是GA监测，那么不论是硬广还是SEM，通常都会在广告链接上加入utm参数已标记该次访问用户的来源。</p>
<p>那么问题就来了：如果我需要在界面上显示中文(比如标记的关键词)，该怎么做呢？GA默认是不会识别参数中的中文的，如果直接添加标记的话后果会比较严重，会导致你GA后台满目疮痍，显示出一堆的乱码，运气好的时候还能费点劲分辨出来，运气不好的话就没办法看报告了。这个时候我们就需要将要标记的内容进行encode转码。在网上有很多的工具可以做到转码，但是批量的基本没有，但是EXCEL的强大之处在这个时候就体现出来了，通过VB定义一个函数，然后像=SUM一样轻松地调用这个函数，就可以愉快地进行批量转码标记了，绝对是SEM同学居家旅行之必备良药。话不多说，我们开始：</p>
<span id="more"></span>

<p>操作其实很简单，几步可以搞定：</p>
<p>一、新建一个EXCEL文件，<strong>另存为-保存类型-Excel 启用宏的工作簿</strong></p>
<p><a target="_blank" rel="noopener" href="http://jackie.ms/wp-content/uploads/2013/04/lingcunwei1.jpg"><img src="http://jackie.ms/wp-content/uploads/2013/04/lingcunwei1.jpg" alt="lingcunwei"></a></p>
<p>二、找到“<strong>开发工具</strong>”选项卡，选择<strong>Visual Basic</strong>（如果没有该选项卡，则在<strong>开始-选项-自定义功能区</strong>，将&lt;<strong>开发工具</strong>&gt;勾上就好）</p>
<p><a target="_blank" rel="noopener" href="http://jackie.ms/wp-content/uploads/2013/04/shezhidaohang.jpg"><img src="http://jackie.ms/wp-content/uploads/2013/04/shezhidaohang.jpg" alt="shezhidaohang"></a></p>
<p>三、回到界面，选择Visual Basic</p>
<p><a target="_blank" rel="noopener" href="http://jackie.ms/wp-content/uploads/2013/04/visualbasic.jpg"><img src="http://jackie.ms/wp-content/uploads/2013/04/visualbasic.jpg" alt="visualbasic"></a></p>
<p>四、在Visual Basic界面中，选择<strong>插入-模块</strong></p>
<p><a target="_blank" rel="noopener" href="http://jackie.ms/wp-content/uploads/2013/04/tianjiamokuai.jpg"><img src="http://jackie.ms/wp-content/uploads/2013/04/tianjiamokuai.jpg" alt="tianjiamokuai"></a></p>
<p>&nbsp;</p>
<p>五、在输入框内输入以下代码：</p>
<pre>
Public Function UrlEncode(ByRef szString As String) As String
       Dim szChar   As String
       Dim szTemp   As String
       Dim szCode   As String
       Dim szHex    As String
       Dim szBin    As String
       Dim iCount1  As Integer
       Dim iCount2  As Integer
       Dim iStrLen1 As Integer
       Dim iStrLen2 As Integer
       Dim lResult  As Long
       Dim lAscVal  As Long
       szString = Trim$(szString)
       iStrLen1 = Len(szString)
       For iCount1 = 1 To iStrLen1
           szChar = Mid$(szString, iCount1, 1)
           lAscVal = AscW(szChar)
           If lAscVal >= &H0 And lAscVal <= &HFF Then
              If (lAscVal >= &H30 And lAscVal <= &H39) Or _
                 (lAscVal >= &H41 And lAscVal <= &H5A) Or _
                 (lAscVal >= &H61 And lAscVal <= &H7A) Then
                 szCode = szCode & szChar
              Else

                 szCode = szCode & "%" & Hex(AscW(szChar))
              End If
           Else
              szHex = Hex(AscW(szChar))
              iStrLen2 = Len(szHex)
              For iCount2 = 1 To iStrLen2
                  szChar = Mid$(szHex, iCount2, 1)
                  Select Case szChar
                         Case Is = "0"
                              szBin = szBin & "0000"
                         Case Is = "1"
                              szBin = szBin & "0001"
                         Case Is = "2"
                              szBin = szBin & "0010"
                         Case Is = "3"
                              szBin = szBin & "0011"
                         Case Is = "4"
                              szBin = szBin & "0100"
                         Case Is = "5"
                        szBin = szBin & "0101"
                         Case Is = "6"
                              szBin = szBin & "0110"
                         Case Is = "7"
                              szBin = szBin & "0111"
                         Case Is = "8"
                              szBin = szBin & "1000"
                         Case Is = "9"
                              szBin = szBin & "1001"
                         Case Is = "A"
                              szBin = szBin & "1010"
                         Case Is = "B"
                              szBin = szBin & "1011"
                         Case Is = "C"
                              szBin = szBin & "1100"
                         Case Is = "D"
                              szBin = szBin & "1101"
                         Case Is = "E"
                              szBin = szBin & "1110"
                         Case Is = "F"
                              szBin = szBin & "1111"
                         Case Else
                  End Select
              Next iCount2
              szTemp = "1110" & Left$(szBin, 4) & "10" & Mid$(szBin, 5, 6) & "10" & Right$(szBin, 6)
              For iCount2 = 1 To 24
                  If Mid$(szTemp, iCount2, 1) = "1" Then
                     lResult = lResult + 1 * 2 ^ (24 - iCount2)
                  Else: lResult = lResult + 0 * 2 ^ (24 - iCount2)
                  End If
              Next iCount2
              szTemp = Hex(lResult)
                    szCode = szCode & "%" & Left$(szTemp, 2) & "%" & Mid$(szTemp, 3, 2) & "%" & Right$(szTemp, 2)
           End If
           szBin = vbNullString
           lResult = 0
       Next iCount1
       UrlEncode = szCode
End Function
</pre>
<p>粘贴代码以后直接CTRL+S保存即可。</p>
<p>四、回到Excel界面，在任意单元格输入公式=URLencode(‘你选择的单元格地址’) ，就可以直接输出转码后的结果了，</p>
<p><a target="_blank" rel="noopener" href="http://jackie.ms/wp-content/uploads/2013/04/jieguo.jpg"><img src="http://jackie.ms/wp-content/uploads/2013/04/jieguo.jpg" alt="jieguo"></a></p>
<p>赶快试试吧！</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.jpg" alt="Jackielzq 微信">
        <span>微信</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechatopen.jpg">
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/encode/" rel="tag"># encode</a>
              <a href="/tags/Excel/" rel="tag"># Excel</a>
              <a href="/tags/%E8%BD%AC%E7%A0%81/" rel="tag"># 转码</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2013/04/02/about-laoluo-rom-about-me/" rel="prev" title="有关老罗ROM发布会的一点感想">
                  <i class="fa fa-chevron-left"></i> 有关老罗ROM发布会的一点感想
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2013/04/09/google-analytics-custom-variable/" rel="next" title="Google Analytics中的自定义变量">
                  Google Analytics中的自定义变量 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2013 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jackielzq</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">183k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">11:06</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
